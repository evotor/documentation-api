swagger: '2.0'
info:
  version: 1.0.3
  title: Протокол исходящих запросов
  description: |
    Этот раздел содержит описание адресов, которые должен поддерживать REST API стороннего сервиса, чтобы получать определённую информацию от облака Эвотор. Сторонний сервис должен авторизовать HTTP-запросы от облака.
    # Авторизация
    В зависимости от способа авторизации, запросы облака Эвотор к стороннему сервису могут содержать заголовок `Authorization` с типом `Basic` или `Bearer`:

      * Если сторонний сервис поддерживает авторизацию с типом `Basic`, в Эвотор требуется предоставить имя пользователя и пароль в формате `username:password`.

      * Если сторонний сервис поддерживает авторизацию с типом `Bearer`, в Эвотор требуется предоставить токен в формате `string`.

      После запросов `/create`, `/verify`, `/tariff`, сторонний сервис сообщает облаку Эвотор токен пользователя, который необходим, чтобы авторизовать все запросы облака, кроме `/create`, `/verify`, `/tariff`.

      Сторонний веб-сервис также может обращаться в облако Эвотор за дополнительной информацией. Токен для авторизации таких запросов, облако Эвотор отправляет на адрес `http://<веб-адрес стороннего сервиса>/api/v1/user/token`. Подробнее, см. раздел "Авторизация" на странице [REST API облака Эвотор](https://developer.evotor.ru/evotor-cloud-rest-api/)
tags:
  - name: Учётные записи в стороннем сервисе
    description: |
      Запросы от облака Эвотор к стороннему сервису для управления учётными записями.
  - name: Биллинг
    description: Запросы и события связанные с биллингом пользователей платформы и сторонних сервисов.
  - name: Сущности пользователя Эвотор
    description: |
      Изменения в Личном  кабинете пользователя платформы Эвотор дублируются в стороннем сервисе. Для дублирования, облако Эвотор обращается к стороннему сервису с запросами на создание / редактирование магазинов, сотрудников и терминалов.
  - name: Товары и документы
    description: Вызовы к системе партнера в контексте товароучетных сущностей
  - name: Поиск товара
    description: Запросы для поиска товаров в базе стороннего сервиса по штрихкоду или алкокоду (коду алкогольной продукции).
  - name: Отправка чека
    description: Отправляет в сторонний сервис упрощенную структуру документа.
host: partner.com
schemes:
  - https
  - http
produces:
  - application/json
consumes:
  - application/json
paths:
  /api/v1/user/verify:
    post:
      tags:
        - Учётные записи в стороннем сервисе
      summary: Авторизация пользователя
      description: |
        Авторизация существующего пользователя в стороннем сервисе с помощью данных учётной записи платформы Эвотор.
        **ВАЖНО:** Под пользователем понимается мастер-аккаунт владельца бизнеса в системе партнера
      parameters:
        - $ref: '#/parameters/serverAuth'
        - name: ''
          in: body
          description: |
            Поля, необходимые для авторизации существующего пользователя в стороннем сервисе.
          required: true
          schema:
            $ref: '#/definitions/authorizeFormData'
      responses:
        '200':
          description: OK
          schema:
            title: Данные пользователя
            type: object
            required:
              - userUuid
              - hasBilling
              - token
            properties:
              userUuid:
                type: string
                description: Уникальный идентификатор пользователя в платформе Эвотор.
                pattern: '^[0-9]{2}-[0-9]{15}$'
                default: 01-000000000000001
              hasBilling:
                type: boolean
                description: |
                  Определяет наличие биллинга по данному пользователю в стороннем сервисе. Эвотор не выполняет биллинг, если на момент авторизации пользователь оплачивает подписку в стороннем сервисе.
                  Работает, когда учётная запись, первоначально зарегестрированна через интерфей партнёра.
              token:
                description: |
                  Токен, который облако Эвотор будет передавать в заголове `Authorization` с типом `Bearer`, для авторизации своих HTTP-запросов в стороннем сервисе.
                type: string
                maxLength: 128
                default: toaWaep4chou7ahkoogiu9Iusaht9ima
  /api/v1/user/create:
    post:
      tags:
        - Учётные записи в стороннем сервисе
      summary: Создать учётную запись
      description: |
        Регистрирует новую учётную запись в стороннем сервисе.
        **ВАЖНО:** Под пользователем понимается мастер-аккаунт владельца бизнеса в системе партнера.
      parameters:
        - $ref: '#/parameters/serverAuth'
        - name: ''
          in: body
          description: |
            Поля необходимые для регистрации нового пользователя в стороннем сервисе.
          required: true
          schema:
            $ref: '#/definitions/registerFormData'
      responses:
        '200':
          description: OK
          schema:
            title: Данные пользователя
            type: object
            required:
              - userUuid
              - token
            properties:
              userUuid:
                type: string
                description: Уникальный идентификатор пользователя в платформе Эвотор
                pattern: '^[0-9]{2}-[0-9]{15}$'
                default: 01-000000000000001
              token:
                description: |
                  Токен, который облако Эвотор будет передавать в заголове `Authorization` с типом `Bearer`, для авторизации своих HTTP-запросов в стороннем сервисе.
                type: string
                maxLength: 128
                default: toaWaep4chou7ahkoogiu9Iusaht9ima
  /api/v1/user/tariff:
    post:
      tags:
        - Биллинг
      summary: Активация / деактивация тарифа
      description: |
        Активация / деактивация тарифа для учетной записи пользователя в стороннем сервисе.
      parameters:
        - $ref: '#/parameters/serverAuth'
        - name: ''
          in: body
          description: |
            Параметры, необходимые для активации тарифа в стороннем сервисе.
          required: true
          schema:
            type: object
            required:
              - userUuid
              - tariffId
              - status
            properties:
              userUuid:
                type: string
                description: Уникальный идентификатор пользователя в платформе Эвотор.
                pattern: '^[0-9]{2}-[0-9]{15}$'
                default: 01-000000000000001
              tariffId:
                type: string
                description: Код тарифа в платформе Эвотор.
                pattern: '^[a-zA-Z0-9\_\-]+$'
                default: starter
              status:
                type: string
                description: >-
                  Статус тарифа. Возможные значения:
                   * ACTIVE -  установка приложения или подтверждение активности тарифа.
                   * INACTIVE - удаление приложение или деактивация тарифа из-за неоплаты.
                enum:
                  - ACTIVE
                  - INACTIVE
      responses:
        '200':
          description: OK
  /api/v1/inventories/devices:
    put:
      tags:
        - Сущности пользователя Эвотор
      summary: Создать смарт-терминал
      description: |
        Создать / отредактировать один или несколько смарт-терминалов в стороннем сервисе. Облако эвотор передаёт в сторонний сервис все изменения, сделанные в Личном кабинете. Эвотор является
        мастер-системой по данной сущности.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: device
          in: body
          description: Массив смарт-терминалов
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/device'
      responses:
        '200':
          description: OK
          schema:
            title: Массив привязок
            type: array
            items:
              type: object
              properties:
                uuid:
                  type: string
                  pattern: >-
                    ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
                partnerId:
                  type: string
                  description: >-
                    Идентификатор сервиса посредника. Сервис посредник хранит соответствие сущностей платформы Эвотор и стороннего сервиса, если он не интегрирован непосредственно с платформой. Если сторонний сервис интегрируется непосредственно с платформой Эвотор, атрибут возвращать не требуется.
  /api/v1/inventories/employees:
    put:
      tags:
        - Сущности пользователя Эвотор
      summary: Создать сотрудника
      description: |
        Создать / отредактировать одного или нескольких сотрудников в стороннем сервисе. Облако эвотор передаёт в сторонний сервис все изменения, сделанные в Личном кабинете. Эвотор является
        мастер-системой по данной сущности.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: employee
          in: body
          description: Массив сотрудников, созданных в платформе Эвотор.
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/employee'
      responses:
        '200':
          description: OK
          schema:
            title: Массив привязок
            type: array
            items:
              type: object
              properties:
                uuid:
                  type: string
                  pattern: >-
                    ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
                partnerId:
                  type: string
                  description: >-
                    Идентификатор сервиса посредника. Сервис посредник хранит соответствие сущностей платформы Эвотор и стороннего сервиса, если он не интегрирован непосредственно с платформой. Если сторонний сервис интегрируется непосредственно с платформой Эвотор, атрибут возвращать не требуется.
  /api/v1/inventories/stores:
    put:
      tags:
        - Сущности пользователя Эвотор
      summary: Создать магазин
      description: >-
        Создать / отредактировать однин или несколько магазинов в стороннем сервисе. Облако эвотор передаёт в сторонний сервис все изменения, сделанные в Личном кабинете. Эвотор является
        мастер-системой по данной сущности.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: store
          in: body
          description: Массив магазинов из Эвотор
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/store'
      responses:
        '200':
          description: OK
          schema:
            title: Массив привязок
            type: array
            items:
              type: object
              properties:
                uuid:
                  type: string
                  pattern: >-
                    ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
                partnerId:
                  type: string
                  description: >-
                    Идентификатор сервиса посредника. Сервис посредник хранит соответствие сущностей платформы Эвотор и стороннего сервиса, если он не интегрирован непосредственно с платформой. Если сторонний сервис интегрируется непосредственно с платформой Эвотор, атрибут возвращать не требуется.
  '/api/v1/inventories/stores/{storeUuid}/products':
    get:
      tags:
        - Товары и документы
      summary: Получить товары
      description: |
        Возвращает номенклатуру из стороннего сервиса в облако Эвотор. Возвращает все товары (`products`) в рамках выбранного магазина (`storeUuid`). Укажите параметры page и size чтобы получить результаты в постраничном режиме.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: storeUuid
          in: path
          description: Уникальный идентификатор магазина в облаке Эвотор.
          required: true
          type: string
          pattern: >-
            ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
        - name: page
          in: query
          description: |
            Включает режим постраничного вывода и задаёт номер страницы в выборке. Используйте вместе с параметром `size`.
          type: integer
          minimum: 0
        - name: size
          in: query
          description: |
            Включает режим постраничного вывода и задаёт размер страницы в выборке. Используйте вместе с параметром `page`.
          type: integer
          minimum: 1
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              $ref: '#/definitions/product'
          headers:
            X-Total-Items-Count:
              description: |
                Общее количество элементов в многостраничной выборке. Возвращается, если в запросе указаны параметры `page` и `size`.
                > Число возвращаемых элементов, должно совпадать с числом, указанным в заголовке.
              type: integer
              minimum: 0
            X-Pagination-Page-Size:
              description: |
                Количество элементов на текущей странице в многостраничной выборке. Возвращается, если в запросе указаны параметры `page` и `size`.
              type: integer
              minimum: 0
            X-Pagination-Next-Page:
              description: |
                Номер следующей страницы в многостраничной выборке. Возвращается, если в запросе указаны параметры `page` и `size`, и существует следующая страница.
              type: integer
              minimum: 1
            X-Pagination-Total-Page-Count:
              description: >-
                Общее количество страниц в многостраничной выборке. Возвращается, если в запросе указаны параметры `page` и `size`.
              type: integer
              minimum: 1
    post:
      tags:
        - Товары и документы
      summary: Создать товары
      description: |
        Загружает в сторонний сервис массив новых товаров, созданных на терминале.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: storeUuid
          in: path
          required: true
          type: string
          pattern: >-
            ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
        - name: products
          in: body
          description: Массив товаров
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/product'
      responses:
        '200':
          description: OK
          schema:
            title: Массив привязок
            type: array
            items:
              type: object
              properties:
                uuid:
                  type: string
                  pattern: >-
                    ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
                id:
                  type: string
  '/api/v1/inventories/stores/{storeUuid}/documents':
    put:
      tags:
        - Товары и документы
      summary: Передать документы
      description: |
        Передаёт в сторонний сервис массив документов с транзакциями.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: storeUuid
          in: path
          required: true
          type: string
          pattern: >-
            ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
        - name: documents
          in: body
          description: Массив документов
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/document'
      responses:
        '200':
          description: OK
  /api/v1/commodities:
    get:
      tags:
        - Поиск товара
      summary: По штрихкоду
      description: |
        Возвращает объект с информацией о товаре, найденного с помощью штрихкода и/или кода алкогольной продукции в базе стороннего сервиса.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: scanCode
          in: query
          required: true
          type: string
        - name: alcCode
          in: query
          required: false
          type: string
      responses:
        '200':
          schema:
            $ref: '#/definitions/commodity'
          description: OK
  /api/v1/receipt:
    post:
      tags:
        - Отправка чека
      summary: Отправить чек
      description: |
        После оплаты отправляет чек в сторонний сервис. Тело запроса содержит один или несколько чеков.
      parameters:
        - $ref: '#/parameters/clientAuth'
        - name: receipt
          in: body
          description: Массив чеков.
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/receipt'
      responses:
        '200':
          description: OK
parameters:
  serverAuth:
    name: Authorization
    in: header
    description: |
      Авторизация запросов облака Эвотор в стороннем сервисе. Содержит токен в зависимости от типа авторизации: Basic или Bearer.
    required: true
    type: string
    pattern: '^(Bearer|Basic) [a-zA-Z0-9_=-]+$'
    default: Bearer evotor_token
  clientAuth:
    name: Authorization
    in: header
    description: |
      Авторизация запросов облака Эвотор в стороннем сервисе. Содержит Bearer-токен авторизации.
    required: true
    type: string
    pattern: '^Bearer [a-zA-Z0-9_=-]+$'
definitions:
  registerFormData:
    type: object
    required:
      - userUuid
    properties:
      userUuid:
        type: string
        description: |
          Уникальный идентификатор пользователя платформы Эвотор.
        pattern: '^[0-9]{2}-[0-9]{15}$'
        default: 01-000000000000001
      username:
        type: string
        description: Имя пользователя
        default: v.pupkin
      password:
        type: string
        description: Пароль
        default: superpassword
      email:
        description: E-mail адрес
        type: string
        pattern: >-
          ^[а-яА-Яa-zA-Z0-9\_\-\.]+\@[а-яА-Яa-zA-Z0-9\_\-\.]+\.[а-яА-Яa-zA-Z0-9\_\-\.]+$
        default: v.pupkin@pupk.in
      phone:
        type: string
        description: Номер телефона
        pattern: '^\+7[0-9]{10}$'
        default: '+79876543210'
      customField:
        type: string
        description: |
          Дополнительное поле для данных пользователя, которые облако передаёт в сторонний сервис во время авторизации или регистрации пользователя. Название поля характеризует его содержимое. Поле отображается в форме регистрации / авторизации на странице приложения в Магазине приложений. Форма может содержать не более шести полей. Запрещается добавлять поля для данных, которые пользователь может указать в Личном кабинете, после установки приложения.
        default: Пример значения
  authorizeFormData:
    type: object
    required:
      - userUuid
    properties:
      userUuid:
        type: string
        description: Уникальный идентификатор пользователя платформы Эвотор
        pattern: '^[0-9]{2}-[0-9]{15}$'
        default: 01-000000000000001
      username:
        type: string
        description: Имя пользователя
        default: v.pupkin
      password:
        type: string
        description: Пароль
        default: superpassword
      customField:
        type: string
        description: |
          Дополнительное поле для данных пользователя, которые облако передаёт в сторонний сервис во время авторизации или регистрации пользователя. Название поля характеризует его содержимое. Поле отображается в форме регистрации / авторизации на странице приложения в Магазине приложений. Форма может содержать не более шести полей. Запрещается добавлять поля для данных, которые пользователь может указать в Личном кабинете, после установки приложения.
        default: Пример значения
  trialStarted:
    type: object
    properties:
      type:
        type: string
        description: |
            Тип события: `trialStarted`.
        default: trialStarted
      date:
        type: string
        format: date-time
        description: Дата и время активации пробного периода.
      data:
        type: object
        properties:
          trialDuration:
            type: number
            description: Длительность пробного периода.
            default: 30
          trialPeriodMeasure:
            type: string
            description: Единица измерения длительности пробного периода.
            enum:
              - day
              - month
              - year
            default: day
          userUuid:
            type: string
            description: Уникальный идентификатор пользователя платформы Эвотор.
            pattern: '^[0-9]{2}-[0-9]{15}$'
            default: 01-000000000000001
          tariffId:
            type: string
            description: Код тарифа, для которого активирован пробный период.
            pattern: '^[a-zA-Z0-9\_\-]+$'
            default: starter
  paymentSuccessed:
    type: object
    properties:
      type:
        type: string
        description: |
          Тип события: `paymentSuccessed`.
        default: paymentSuccessed
      date:
        type: string
        format: date-time
        description: Дата и время платежа.
      data:
        type: object
        properties:
          amount:
            type: number
            format: float
            description: Размер платежа.
            default: 999.99
          currency:
            type: string
            description: Валюта платежа.
            enum:
              - RUB
            default: RUB
          userUuid:
            type: string
            description: Уникальный идентификатор пользователя платформы Эвотор
            pattern: '^[0-9]{2}-[0-9]{15}$'
            default: 01-000000000000001
          tariffId:
            type: string
            description: Код оплаченного тарифа.
            pattern: '^[a-zA-Z0-9\_\-]+$'
            default: starter
  subscriptionActivated:
    type: object
    properties:
      type:
        type: string
        description: |
          Тип события: `subscriptionActivated`.
        default: subscriptionActivated
      date:
        type: string
        format: date-time
        description: Дата и время активации платного периода.
      data:
        type: object
        properties:
          userUuid:
            type: string
            description: Уникальный идентификатор пользователя платформы Эвотор.
            pattern: '^[0-9]{2}-[0-9]{15}$'
            default: 01-000000000000001
          tariffId:
            type: string
            description: Код тарифа, для которого активирован платный период.
            pattern: '^[a-zA-Z0-9\_\-]+$'
            default: starter
  paymentFailed:
    type: object
    properties:
      type:
        type: string
        description: |
          Тип события: `paymentFailed`.
        default: paymentFailed
      date:
        type: string
        format: date-time
        description: Дата и время неудачного платежа.
      data:
        type: object
        properties:
          amount:
            type: number
            format: float
            description: Размер платежа.
            default: 999.99
          currency:
            type: string
            description: Валюта платежа.
            enum:
              - RUB
            default: RUB
          nextPaymentAtemptInDays:
            type: integer
            description: Через сколько дней будет повторная попытка платежа.
            default: 1
          error:
            type: string
            description: Описание ошибки.
            default: Недостаточно средств
          userUuid:
            type: string
            description: Уникальный идентификатор пользователя платформы Эвотор.
            pattern: '^[0-9]{2}-[0-9]{15}$'
            default: 01-000000000000001
          tariffId:
            type: string
            description: |
              Код тарифа, который оплачивал пользователь.
            pattern: '^[a-zA-Z0-9\_\-]+$'
            default: starter
  product:
    type: object
    required:
      - alcoCodes
      - alcoholByVolume
      - alcoholProductKindCode
      - allowToSell
      - articleNumber
      - barCodes
      - code
      - costPrice
      - description
      - fields
      - group
      - measureName
      - name
      - parentUuid
      - price
      - quantity
      - tareVolume
      - tax
      - type
      - uuid
    properties:
      uuid:
        type: string
        description: >-
          Уникальный идентификатор товара/группы в формате uuid4; уникален в
          рамках магазина; не может быть пустой строкой
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      code:
        type: string
        description: Код товара либо группы; не может быть null
        minLength: 0
        maxLength: 10
      barCodes:
        type: array
        description: >-
          Массив штрихкодов товара; для групп товаров - пустой массив; не может
          быть null
        items:
          type: string
          pattern: '^[0-9]$'
          minLength: 1
      alcoCodes:
        type: array
        description: >-
          Массив строк алкокодов (кодов алкогольной продукции ЕГАИС); для групп
          товаров - пустой массив; не может быть null; алкокод не может быть
          пустой строкой и null
        items:
          type: string
          pattern: '^[0-9]{19}$'
      name:
        type: string
        description: Наименование товара/группы; не может быть пустой строкой и null
        minLength: 1
        maxLength: 100
      price:
        type: number
        format: float
        minimum: 0
        maximum: 9999999.99
        description: Отпускная цена товара; для групп товаров - 0; не может быть null
      quantity:
        type: number
        format: float
        description: >-
          Количество товара в наличии (остаток); до 3 знаков в дробной части;
          для групп товаров - 0; не может быть null
      costPrice:
        type: number
        format: float
        minimum: 0
        maximum: 9999999.99
        description: Закупочная цена; для групп товаров - 0; не может быть null
      measureName:
        type: string
        description: >-
          Единица измерения для товара; для групп товаров - ""; не может быть
          null
        enum:
          - ''
          - шт
          - кг
          - л
          - м
          - км
          - м2
          - м3
          - компл
          - упак
          - ед
          - дроб
      tax:
        type: string
        description: >-
          Ставка НДС; для групп товаров - "NO_VAT"; не может быть null и пустой
          строкой
        enum:
          - NO_VAT
          - VAT_10
          - VAT_18
          - VAT_0
          - VAT_18_118
          - VAT_10_110
      allowToSell:
        type: boolean
        description: >-
          Флаг доступности товара для продажи; true - товар доступен для
          добавления в чек, false - товар не доступен для добавления в чек; для
          групп товаров - true; не может быть null
      description:
        type: string
        description: Описание товара; для групп товаров - ""; не может быть null
        minLength: 0
      articleNumber:
        type: string
        description: Артикул; для групп товаров - ""; не может быть null
        minLength: 0
        maxLength: 20
      parentUuid:
        type: string
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
        description: >-
          Уникальный идентификатор группы, к которой принадлежит товар либо
          группа, в формате uuid4; группа может быть включена в другую группу;
          если товар/группа находится в корне иерархии, - может быть null; не
          может быть пустой строкой
      group:
        type: boolean
        description: >-
          Определяет, является ли элемент группой товаров; true - группа, false
          - товар; не может быть null
      type:
        type: string
        description: >-
          Тип товара; обычный ("NORMAL"), маркированный алкоголь
          ("ALCOHOL_MARKED"), немаркированный алкоголь("ALCOHOL_NOT_MARKED");
          для групп товаров - "NORMAL"; не может быть null
        enum:
          - NORMAL
          - ALCOHOL_MARKED
          - ALCOHOL_NOT_MARKED
      alcoholByVolume:
        type: number
        format: float
        minimum: 0
        maximum: 99.999
        description: >-
          Крепость алкогольной продукции, до 3 знаков в дробной части; для
          неалкогольных типов товаров и групп - 0; для алкоголя - в диапазоне от
          0.001 до 99.999; не может быть null
      alcoholProductKindCode:
        type: integer
        minimum: 0
        maximum: 999
        description: >-
          Код вида алкогольной продукции ФСРАР; для неалкогольных типов товаров
          и групп - 0; для алкоголя - в диапазоне от 1 до 999; не может быть
          null
      tareVolume:
        type: number
        format: float
        minimum: 0
        maximum: 999.999
        description: >-
          Ёмкость тары алкогольной продукции в литрах, до 3 знаков после запятой. Для неалкогольных товаров и групп - 0. Для алкоголя - в
          диапазоне от 0.001 до 999.999; не может быть null
      fields:
        type: object
        description: >-
          Дополнительные атрибуты товара, не входящие в стандартную схему; не
          может быть null
  employee:
    type: object
    required:
      - uuid
      - role
      - name
      - stores
    properties:
      uuid:
        type: string
        description: |
          Уникальный идентификатор сотрудника в платформе Эвотор, в формате uuid4. Не может содержать пустую строку или принимать значение `null`.
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      name:
        type: string
        description: Имя сотрудника в платформе Эвотор. Не может содержать пустую строку или принимать значение `null`.
      lastName:
        type: string
        description: Фамилия сотрудника в платформе Эвотор.
      patronymicName:
        type: string
        description: Отчество сотрудника в платформе Эвотор.
      phone:
        type: number
        description: Номер телефона сотрудника в платформе Эвотор.
        pattern: '^7[0-9]{10}$'
        default: 79876543210
      stores:
        type: array
        description: Массив идентификаторов магазинов, к которым привязан идентификатор сотрудника.
        items:
          type: object
          properties:
            storeUuid:
              type: string
              description: |
                Уникальный идентификатор магазина в платформе Эвотор, в формате uuid4. Не может содержать пустую строку или принимать значение `null`.
              pattern: >-
                ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      role:
        type: string
        description: |
          Роль, которая задаёт права доступа сотрудника. В зависимости от прав, сотрудники имеют доступ к различным функциям смарт-терминала.
        enum:
          - ADMIN
          - CASHIER
          - OTHER
  store:
    type: object
    required:
      - uuid
      - name
    properties:
      uuid:
        type: string
        description: >-
          Уникальный идентификатор магазина в облаке Эвотор, в формате uuid4. Не может содержать пустую строку или принимать значение `null`.
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      name:
        type: string
        description: Имя магазина в платформе Эвотор. Не может содержать пустую строку или принимать значение `null`.
      address:
        type: string
        description: Адрес магазина в платформе Эвотор.
  document:
    type: object
    required:
      - uuid
      - type
    properties:
      uuid:
        type: string
        description: >-
          Уникальный идентификатор документа в платформе Эвотор, в формате uuid4. Уникален в рамках магазина (`storeUuid`).
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      type:
        type: string
        enum:
          - SELL
          - PAYBACK
          - CASH_INCOME
          - CASH_OUTCOME
          - OPEN_SESSION
          - FPRINT
          - CLOSE_SESSION
          - INVENTORY
          - ACCEPT
          - RETURN
          - WRITE_OFF
          - REVALUATION
          - OPEN_TARE
      transactions:
        type: array
        items:
          $ref: '#/definitions/transaction'
  transaction:
    type: object
    properties:
      type:
        type: string
        enum:
          - DISCOUNT_DOCUMENT
          - DISCOUNT_POSITION
          - DISCOUNT_DOCUMENT_POSITION
          - DOCUMENT_OPEN
          - DOCUMENT_CLOSE
          - DOCUMENT_CLOSE_FPRINT
          - REGISTER_POSITION
          - REGISTER_BILLS
          - CASH_INCOME
          - CASH_OUTCOME
          - INVENTORY
          - PAYMENT
          - OPEN_SESSION
          - CLOSE_SESSION
          - FPRINT_OPEN_SESSION
          - FPRINT_X_REPORT
          - FPRINT_Z_REPORT
          - POSITION_TAX
          - REVALUATION
  device:
    type: object
    properties:
      uuid:
        type: string
        description: Уникальный идентификатор смарт-терминала в платформе Эвотор, в формате uuid4.
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
      name:
        type: string
        description: Имя смарт-терминала в платформе Эвотор. Не может содержать пустую строку или принимать значение `null`.
        minLength: 1
      storeUuid:
        type: string
        description: >-
          Уникальный идентификатор магазина в платформе Эвотор, к которому привязан смарт-терминал. Формат идентификатора - uuid4. Не может содержать пустую строку или принимать значение `null`.
        pattern: >-
          ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
  commodity:
    type: object
    properties:
      name:
        type: string
        description: Название товара.
      alcCodes:
        type: array
        items:
          type: string
      scanCodes:
        type: array
        items:
          type: string
      alcoholByVolume:
        type: string
        description: Крепость алкогольной продукции.
      alcoholProductKindCode:
        type: string
        description: Код вида алкогольной продукции.
      tareVolume:
        type: string
        description: Ёмкость тары алкогольной продукции в литрах, до 3 знаков после запятой.
      measure:
        type: string
        description: Единицы измерения.
  receipt:
    type: object
    required:
      - uuid
      - deviceUuid
      - storeUuid
      - dateTime
    properties:
      uuid:
        type: string
        description: Уникальный идентификатор чека.
      deviceUuid:
        type: string
        description: Уникальный идентификатор смарт-терминала.
      storeUuid:
        type: string
        description: Уникальный идентификатор магазина.
      dateTime:
        description: Дата и время.
        type: string
        format: date-time
      type:
        description: |
          Тип чека: продажа или возврат.
        type: string
      shiftId:
        description: Номер смены.
        type: string
      employeeUuid:
        type: string
        description: Уникальный идентификатор сотрудника (пользователя, продавшего товар).
      paymentSource:
        description: |
          Способ оплаты:
            * PAY_CASH - оплата наличными без сдачи;
            * PAY_CASHBACK – оплата наличными со сдачей;
            * PAY_CARD - оплата по карте.
        type: string
        enum:
          - PAY_CASH
          - PAY_CASHBACK
          - PAY_CARD
          - OTHER
      infoCheck:
        type: boolean
        description: Информационный чек. Возможные значения true или false.
      egais:
        type: boolean
        description: ЕГАИС. Возможные значения true или false.
      items:
        type: array
        description: Массив с позициями в чеке.
        items:
          type: object
          properties:
            uuid:
              type: string
              description: Уникальный идентификатор товара / услуги.
            name:
              type: string
              description: Наименование товара / услуги.
            itemType:
              type: string
              description: |
                Тип товара:
                  * обычный;
                  * маркированный алкоголь;
                  * немаркированный алкоголь.
                  * услуга.
              enum:
                - NORMAL
                - ALCOHOL_MARKED
                - ALCOHOL_NOT_MARKED
                - SERVICE
            barcode:
              type: string
            measureName:
              type: string
              description: Единица измерения.
            quantity:
              type: number
              description: Кол-во товара.
            price:
              type: number
              description: Цена продажи товара.
            costPrice:
              type: number
              description: Цена закупки товара.
            sumPrice:
              type: number
              description: Общая цена товара/
            tax:
              type: number
              description: Cумма налога на товар.
            taxPercent:
              type: number
              description: Общий налог на товар. Выражается в процентах.
            discount:
              type: number
              description: Общая сумма скидки на товар.
      totalTax:
        type: number
        description: Общая сумма налога.
      totalDiscount:
        type: number
        description: Общая сумма скидки.
      totalAmount:
        type: number
        description: Общая сумма чека.
      clientUuid:
        type: string
        description: |
          Уникальный идентификатор (`uuid`) клиента. Появляется после того, как клиент указал номер телефона, e-mail или другие данные, например в программе лояльности.
      fields:
        type: object
        description: |
          Дополнительные поля. Нпример, поля пользователей программ лояльности. Поля передаются только в те сторонние сервисы, где они были созданы.
